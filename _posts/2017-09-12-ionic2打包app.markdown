---
layout: post
title: Android app 打包详细过程
date: 2018-09-29 15:15:00 +0300
description: 
img: software.jpg # Add image post (optional)
tags: [Android, App,打包] # add tag
---
可参考链接（仅参考）：
- onic官方文档链接：http://ionicframework.com/docs/
- ionic2打包详解：https://segmentfault.com/a/1190000010194942
- ionic3打包详解：https://www.cnblogs.com/chenglu/p/8608121.html
- ionic3打包：https://blog.csdn.net/qq_20264891/article/details/79319408
- node.js安装教程：https://www.jianshu.com/p/03a76b2e7e00

我的环境版本：
- node.js: 8.12.0
- jdk: 1.8.0_181
- cordova:6.5.0
- ionic:2.0.0

相关软件：

连接：https://pan.baidu.com/s/10N4gjkg1m6N5QMR84n3aSQ

密钥：8083

主要流程

安装node.js  -->  安装jdk  -->  安装AndroidSDK  -->  安装cordova  -->  安装ionic -->  创建项目  -->  编译项目apk

### 软件安装

- 安装nodeJS（自带npm）
- 配置cnpm （使用淘宝镜像取代npm）
- 安装cordova和ionic2
- 安装JAVA JDK
- 安装Android SDK(在项目打包安卓app的时候会用到，前期在浏览器环境测试开发暂时用不到)

####1、安装node.js
- 相关软件都在上面给的百度云链接中。如果要自己下载，可以去[node.js官网](https://nodejs.org/en/download/) 下载对应系统版本，注意一点ionic2的开发需求Node版本要大于v6，一般下载最新正式版。
- 安装完成后，检测是否成功配置了Node，打开命令提示符：按下Win+R -> 输入"cmd" -> 输入命令 node -v，有显示版本号即表示安装成功。输入npm –v检查安装版本。
- 在安装的node.js文件夹下新建**node_cache**和**node_global**文件夹。
- 创建完成后打开cmd，输入：

```
  npm config set prefix "你的node_global路径"
  npm config set cache "你的node_cache路径"

```
- 设置环境变量：在系统变量中，新建 --> 变量名为：**NODE_PATH**,变量值为：node_global下面的node_modules的绝对路径。在用户变量的path中添加node_global的绝对路径，主要前后的英文分号。

####2、安装淘宝镜像cnpm

```angular2html
  npm install -g cnpm --registry=https://registry.npm.taobao.org
  
  需要注意一点就是cnpm 不支持 publish 命令。
```
配置npm国内镜像：

因为国内的网络环境原因，在用npm下载安装各种包的时候经常会遇到无法正常下载的情况。所以我们需要将npm指向淘宝镜像 。cmd中分步输入以下内容：

(1)、注册模块镜像：npm set registry https://registry.npm.taobao.org/

(2)、编译依赖的node的源码镜像：npm set distury https://npm.taobao.org/dist

(3)、清空缓存： npm 
最后查看一下npm配置列表是否已经指向淘宝镜像：npm config list

####3、用cnpm安装cordova和ionic2

```angular2html
    先安装 cordova：cnpm install –g cordova@6.5.0
    再安装 ionic: cnpm install –g ionic@2.0.0
```
> 安装6.x版本，我用7.x版本给项目添加Android平台会报错，不知道是不是个例，没有做其他测试）。安装完成输入cordova –v查看版本号以及是否安装成功（第一次使用cordova命令时会跳出个选择问你是否打小报告，自行选择y或n，一般选y以协助官方对产品进行改进）。
这两个安装完成会显示All packages installed…字样。输入ionic –v查看版本号以及是否安装成功。

####4、 安装JAVA JDK（无需配置环境）
同样的百度云网盘中有或[官网下载](https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)。下载完成，一路下一步就可以了，安装完成输入java –version看一下是否安装成功以及版本号。安装路径最好建一个文件夹，和等会的sdk放在一起，方便找。注意，路径中不能有中文。

####5、安装SDK（需要配环境变量）
- 同样的百度云网盘中有或[官网下载](https://segmentfault.com/a/1190000010194942)。最后点击Finish的时候会打开Android SDK Manager，这是下载相关工具用的，在刚才安装的SDK目录下也可直接打开SDK Manager.exe，如果遇到打不开的情况请用管理员运行。
- 翻墙安装插件
打开界面上的Tools,选择options，先配置国内镜像：
域名千万不要输入http或者https协议前缀，
**mirrors.neusoft.edu.cn**
![图1](https://images2018.cnblogs.com/blog/1174856/201803/1174856-20180320110832376-168559089.png)
回到主界面，点packages再点reload
按照下面的勾选（Android SDK Tools,Android SDK platform-tools,Android SDK Build-tools）：
![图2](https://images2018.cnblogs.com/blog/1174856/201803/1174856-20180320110845297-2079719425.png)
![图3](https://images2018.cnblogs.com/blog/1174856/201803/1174856-20180320110855964-1710047611.png)
> 注意：ionic2.3.0已要求API25，所以选Android版本为Android 7.1.1（API25）这里面的SDK Platform。

> 附加：项目集成Crosswalk需要勾选Extras下的Android Support Repository和Google Repository否则会报错

点右下角 install packages 来安装，耐心等待即可。

安装完成后开始配置安卓环境变量：

我的电脑 –> 右键属性 -> 高级系统设置 -> 环境变量

新建变量名：ANDROID_HOME

变量值 ：C:AndroidSDK （你刚才复制的sdk路径）

然后在path里添加(前面注意加一个分号) 
**;%ANDROID_HOME%platform-tools;%ANDROID_HOME%tools**

Win10的话就分两条新建，不需要分号。

配置完成点击确定即可。

最后在cmd里输入android -h看到正常显示安卓的命令就表示已经安装配置成功

####6、创建demo


### Pour-over blue bottle woke listicle

Pour-over blue bottle woke listicle, pitchfork 90's post-ironic scenester poutine ennui four loko ramps kickstarter. Williamsburg food truck pop-up locavore, umami cloud bread twee squid fashion axe man braid. Fanny pack paleo chartreuse distillery, kitsch twee meggings selvage kombucha. Keffiyeh actually prism listicle. Taxidermy authentic iPhone migas vegan copper mug. Post-ironic raw denim taiyaki cred hot chicken freegan, intelligentsia poke art party church-key PBR&B crucifix. Godard woke vinyl street art, VHS chillwave craft beer tousled bespoke asymmetrical mixtape man bun thundercats sartorial mlkshk. Meggings heirloom XOXO gentrify try-hard stumptown. Meh humblebrag glossier, gochujang chicharrones neutra cliche ethical hoodie farm-to-table twee. Messenger bag offal pug bespoke, put a bird on it tote bag literally.

Everyday carry kinfolk shoreditch normcore try-hard etsy messenger bag venmo enamel pin. Try-hard fanny pack thundercats farm-to-table retro twee. Godard photo booth tofu 90's. Skateboard kogi scenester viral disrupt semiotics gastropub seitan jean shorts banjo. Humblebrag knausgaard waistcoat mixtape. Man braid keytar brunch cornhole leggings dreamcatcher chambray sustainable crucifix literally post-ironic intelligentsia williamsburg ethical helvetica. Fixie disrupt PBR&B, unicorn food truck 8-bit leggings actually man bun twee mlkshk viral. Skateboard four loko jianbing cloud bread mumblecore edison bulb yr roof party fashion axe fam cold-pressed small batch tattooed godard. Bushwick yuccie thundercats schlitz listicle skateboard quinoa. Gentrify hot chicken pop-up keytar master cleanse pork belly. Irony pitchfork la croix neutra freegan. Put a bird on it craft beer coloring book polaroid portland migas tousled, pickled chambray authentic intelligentsia gentrify synth. Letterpress tumblr wolf normcore selvage. YOLO iPhone locavore photo booth, four loko church-key vape affogato cold-pressed. Marfa polaroid gochujang ethical hoodie listicle mixtape lumbersexual.
